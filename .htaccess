# Apache configuration for OSP2-BE website

# Enable rewrite engine
RewriteEngine On

# Force HTTPS (optional, uncomment if needed)
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Cache control for static assets
<FilesMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg)$">
    ExpiresActive On
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/jpg "access plus 1 month"
    ExpiresByType image/jpeg "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
    ExpiresByType image/ico "access plus 1 month"
    ExpiresByType image/svg+xml "access plus 1 month"
</FilesMatch>

# Cache control for HTML files
<FilesMatch "\.(html|htm)$">
    ExpiresActive On
    ExpiresByType text/html "access plus 0 seconds"
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires "0"
</FilesMatch>

# Default redirect to English version
DirectoryIndex index.html

# Handle language routing
RewriteCond %{REQUEST_URI} ^/$
RewriteRule ^$ /en/index.html [R=302,L]

# Handle missing language prefix
RewriteCond %{REQUEST_URI} !^/(en|ru)/
RewriteCond %{REQUEST_URI} !^/(assets|scripts|styles)/
RewriteCond %{REQUEST_URI} !^/\.htaccess$
RewriteRule ^(.*)$ /en/$1 [R=302,L]

# Security headers
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"

# MIME types
AddType text/css .css
AddType application/javascript .js
AddType image/png .png
AddType image/jpeg .jpg .jpeg
AddType image/gif .gif
AddType image/svg+xml .svg
