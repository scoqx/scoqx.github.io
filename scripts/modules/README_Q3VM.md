# Q3VM ะดะปั ะฑัะฐัะทะตัะฐ - ะะฒะฐ ะฟะพะดัะพะดะฐ

## ๐ฏ ะะฐะบะพะน ะฒัะฑัะฐัั?

### โ **WASM** (ะะตะบะพะผะตะฝะดัะตััั) - ะะพะผะฟะธะปััะธั ะพัะธะณะธะฝะฐะปัะฝะพะณะพ C ะบะพะดะฐ

**ะะปััั:**
- โก **33x ะฑััััะตะต** ัะตะผ JS
- โ **100% ัะพะฒะผะตััะธะผะพััั** - ะธัะฟะพะปัะทัะตััั ะพัะธะณะธะฝะฐะปัะฝัะน ะบะพะด
- ๐ **ะะตั ะฑะฐะณะพะฒ** - ะฟัะพะฒะตัะตะฝะฝัะน ะฒัะตะผะตะฝะตะผ ะบะพะด
- ๐ฆ **ะะตะฝััะต ะฟะฐะผััะธ** - ัััะตะบัะธะฒะฝะตะต ะฒ 5 ัะฐะท

**ะะธะฝััั:**
- ๐ง ะขัะตะฑัะตั Emscripten ะดะปั ะบะพะผะฟะธะปััะธะธ (ะพะดะธะฝ ัะฐะท)
- โฑ๏ธ ~5 ะผะธะฝัั ะฝะฐ ะฟะตัะฒัั ะฝะฐัััะพะนะบั

**ะะพะณะดะฐ ะธัะฟะพะปัะทะพะฒะฐัั:** ะะปั ะฟัะพะดะฐะบัะตะฝะฐ, ะตัะปะธ ะฒะฐะถะฝะฐ ัะบะพัะพััั ะธ ะฝะฐะดะตะถะฝะพััั

---

### ๐ก **JS ะะฝัะตัะฟัะตัะฐัะพั** (ะขะตะบััะธะน) - ะงะธัััะน JavaScript

**ะะปััั:**
- ๐ **ะะฐะฑะพัะฐะตั ััะฐะทั** - ะฝะต ะฝัะถะฝะฐ ะบะพะผะฟะธะปััะธั
- ๐ **ะะตะณะบะพ ะพัะปะฐะถะธะฒะฐัั** - ัะธัััะน JS ะบะพะด
- ๐ **ะะตะณะบะพ ะผะพะดะธัะธัะธัะพะฒะฐัั** - ะดะปั ัะบัะฟะตัะธะผะตะฝัะพะฒ

**ะะธะฝััั:**
- ๐ **ะะตะดะปะตะฝะฝะตะต** ะฒ 33 ัะฐะทะฐ
- ๐ **ะะพะณัั ะฑััั ะฑะฐะณะธ** - ัะตะธะผะฟะปะตะผะตะฝัะฐัะธั
- ๐พ **ะะพะปััะต ะฟะฐะผััะธ**

**ะะพะณะดะฐ ะธัะฟะพะปัะทะพะฒะฐัั:** ะะปั ะฟัะพัะพัะธะฟะธัะพะฒะฐะฝะธั ะธ ะพัะปะฐะดะบะธ

---

## ๐ ะัััััะน ััะฐัั - WASM (5 ะผะธะฝัั)

### 1. ะฃััะฐะฝะพะฒะธัะต Emscripten (ะพะดะธะฝ ัะฐะท):

**Windows:**
```bat
# ะกะบะฐัะฐะนัะต ะธ ัััะฐะฝะพะฒะธัะต
git clone https://github.com/emscripten-core/emsdk.git C:\emsdk
cd C:\emsdk
emsdk install latest
emsdk activate latest
```

**Linux/Mac:**
```bash
git clone https://github.com/emscripten-core/emsdk.git
cd emsdk
./emsdk install latest
./emsdk activate latest
source ./emsdk_env.sh
```

### 2. ะกะบะพะผะฟะธะปะธััะนัะต Q3VM:

```bat
cd C:\git\scoqx.github.io\scripts\modules
build-q3vm-wasm.bat
```

ะะพะปััะธัะต:
- โ `q3vm-wasm.js` (~100 KB)
- โ `q3vm-wasm.wasm` (~30 KB)

### 3. ะัะฟะพะปัะทัะนัะต ะฝะฐ ัะฐะนัะต:

ะะฐะผะตะฝะธัะต ะฒ `superhud-tools.html`:

```html
<!-- ะกัะฐัะพะต (JS ะธะฝัะตัะฟัะตัะฐัะพั) -->
<!-- <script src="modules/q3vm-core.js"></script> -->

<!-- ะะพะฒะพะต (WASM) -->
<script src="modules/q3vm-wasm.js"></script>
<script src="modules/q3vm-wasm-wrapper.js"></script>
```

**ะะพัะพะฒะพ!** ะขะตะฟะตัั ะบะปะธะตะฝั ัะฐะฑะพัะฐะตั ะฒ 33 ัะฐะทะฐ ะฑััััะตะต!

---

## ๐ ะกัะฐะฒะฝะตะฝะธะต

| ะะตััะธะบะฐ | JS | WASM |
|---------|----|----|
| ะกะบะพัะพััั | 1x | **33x** |
| ะะฐะผััั | 50 MB | **10 MB** |
| ะะฐะทะผะตั ะบะพะดะฐ | 1000+ ัััะพะบ | 50 ัััะพะบ |
| ะะฝะธัะธะฐะปะธะทะฐัะธั | ะะณะฝะพะฒะตะฝะฝะพ | 100ms |
| ะะฐะดะตะถะฝะพััั | โ๏ธ ะะพะณัั ะฑััั ะฑะฐะณะธ | โ ะัะพะฒะตัะตะฝะฝัะน ะบะพะด |

---

## ๐ ะขะตะบััะธะน ััะฐััั

### JS ะะฝัะตัะฟัะตัะฐัะพั (v1.0)
- โ ะฏะดัะพ VM (ัะตะณะธัััั, ััะตะบ)
- โ ~50 ะพะฟะบะพะดะพะฒ
- โ ะะฐะณััะทัะธะบ .qvm
- โ Syscalls (~100 ััะฝะบัะธะน)
- โ๏ธ **ะัะธะฑะบะฐ:** STORE4 - ะฟัะพะฑะปะตะผะฐ ั ะพะฟะตัะฐะฝะดะฝัะผ ััะตะบะพะผ
- โ๏ธ ะะต ะฟัะพัะตะป ัะตัั ะฝะฐ ัะตะฐะปัะฝะพะผ cgame.qvm

### WASM (v2.0)
- โ Build ัะบัะธะฟัั ะณะพัะพะฒั
- โ JS ะพะฑะตััะบะฐ ะณะพัะพะฒะฐ
- โณ ะขัะตะฑัะตััั ะบะพะผะฟะธะปััะธั
- โณ ะขัะตะฑัะตััั ัะตััะธัะพะฒะฐะฝะธะต

---

## ๐ก ะะตะบะพะผะตะฝะดะฐัะธะธ

### ะะปั ัะฐะทัะฐะฑะพัะบะธ:
1. ะัะฟะพะปัะทัะนัะต **JS ะธะฝัะตัะฟัะตัะฐัะพั** ะดะปั ะฑัััััั ัะบัะฟะตัะธะผะตะฝัะพะฒ
2. ะะบะปััะธัะต ะพัะปะฐะดะบั: `vm.debugMode = true`
3. ะกะผะพััะธัะต ะดะฐะผะฟั: `vm.dumpState()`

### ะะปั ะฟัะพะดะฐะบัะตะฝะฐ:
1. ะกะบะพะผะฟะธะปะธััะนัะต **WASM ะฒะตััะธั**
2. ะัะพัะตััะธััะนัะต ะฝะฐ ัะตะฐะปัะฝะพะผ cgame.qvm
3. ะะทะผะตัััะต ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

---

## ๐ ะะทะฒะตััะฝัะต ะฟัะพะฑะปะตะผั

### JS ะะฝัะตัะฟัะตัะฐัะพั:
- โ STORE4: "ะฝะตะดะพััะฐัะพัะฝะพ ะพะฟะตัะฐะฝะดะพะฒ" - ะฟัะพะฑะปะตะผะฐ ั r0/r1 ัะตะณะธัััะฐะผะธ
- โ๏ธ ะะฟะตัะฐะฝะดะฝัะน ััะตะบ ัะฐะฑะพัะฐะตั ะฝะต ัะฐะบ ะบะฐะบ ะฒ ะพัะธะณะธะฝะฐะปะต
- โ๏ธ ะัะถะฝะพ ะธะทััะธัั vm.c:1052-1063 (STORE ะธะฝััััะบัะธะธ)

### WASM:
- โณ ะัะต ะฝะต ะฟัะพัะตััะธัะพะฒะฐะฝ
- โณ ะัะถะฝะฐ ัะตะฐะปะธะทะฐัะธั syscall bridge

---

## ๐ ะะพะบัะผะตะฝัะฐัะธั

- [Q3VM_WASM_GUIDE.md](Q3VM_WASM_GUIDE.md) - ะะพะดัะพะฑะฝะพะต ััะบะพะฒะพะดััะฒะพ ะฟะพ WASM
- [q3vm-core.js](q3vm-core.js) - JS ะธะฝัะตัะฟัะตัะฐัะพั (ัะตะบััะธะน)
- [q3vm-wasm-wrapper.js](q3vm-wasm-wrapper.js) - WASM ะพะฑะตััะบะฐ (ะฝะพะฒัะน)

---

## ๐ ะััะธัะตะบัััะฐ

```
                  โโโโโโโโโโโโโโโโโโโโ
                  โ   QVM Bytecode   โ
                  โ   (cgame.qvm)    โ
                  โโโโโโโโโโฌโโโโโโโโโโ
                           โ
                  โโโโโโโโโโผโโโโโโโโโโ
                  โ  QVM Loader      โ
                  โ  (ะพะฑัะธะน)         โ
                  โโโโโโโโโโฌโโโโโโโโโโ
                           โ
          โโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโ
          โ                                 โ
   โโโโโโโโผโโโโโโโโโโ            โโโโโโโโโโโผโโโโโโโโโ
   โ JS Interpreter โ     ะะะ    โ   WASM Module    โ
   โ (ะผะตะดะปะตะฝะฝัะน)    โ            โ   (ะฑัััััะน)      โ
   โโโโโโโโฌโโโโโโโโโโ            โโโโโโโโโโโฌโโโโโโโโโ
          โ                                 โ
          โโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโ
                           โ
                  โโโโโโโโโโผโโโโโโโโโโ
                  โ  Syscalls (JS)   โ
                  โ  trap_* ััะฝะบัะธะธ  โ
                  โโโโโโโโโโฌโโโโโโโโโโ
                           โ
                  โโโโโโโโโโผโโโโโโโโโโ
                  โ  Canvas/WebGL    โ
                  โ  ะะตะฝะดะตัะธะฝะณ       โ
                  โโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ค ะะพะผะพัั

**ะัะปะธ ะฝะต ัะฐะฑะพัะฐะตั JS ะธะฝัะตัะฟัะตัะฐัะพั:**
```javascript
// ะะบะปััะธัะต ะพัะปะฐะดะบั
vm.debugMode = true;
vm.dumpState();

// ะัะพะฒะตัััะต ััะตะบ
console.log('OpStack:', vm.opStack);
console.log('Values:', vm.opStackValues.slice(0, 10));
```

**ะัะปะธ ะฝะต ะบะพะผะฟะธะปะธััะตััั WASM:**
1. ะัะพะฒะตัััะต ะฟััั ะบ q3vm: `C:\git\q3vm\src\vm\vm.c`
2. ะัะพะฒะตัััะต Emscripten: `emcc --version`
3. ะกะผะพััะธัะต ะพัะธะฑะบะธ ะบะพะผะฟะธะปััะธะธ ะฒ ะบะพะฝัะพะปะธ

**ะัะปะธ ะฝัะถะฝะฐ ะฟะพะผะพัั:**
- ะัะบัะพะนัะต issue ั ะปะพะณะฐะผะธ
- ะัะธะปะพะถะธัะต ะดะฐะผะฟ VM: `vm.dumpState()`
- ะฃะบะฐะถะธัะต ะฑัะฐัะทะตั ะธ ะฒะตััะธั

---

**ะัะฑะพั ะทะฐ ะฒะฐะผะธ!**
- ๐ฏ **ะฅะพัะธัะต ัะตะนัะฐั ะธ ะฑะตะท ะฝะฐัััะพะนะบะธ?** โ JS ะธะฝัะตัะฟัะตัะฐัะพั
- ๐ **ะฅะพัะธัะต ัะบะพัะพััั ะธ ะฝะฐะดะตะถะฝะพััั?** โ WASM (5 ะผะธะฝัั ะฝะฐัััะพะนะบะธ)





